<!DOCTYPE html><html lang="en"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description"><meta name="google-site-verification" content="GY3xi-El9ePp4mSskpCuCNS4x4elE7wbFPe2eKCtS8Y"><title>Sort List | Xinli's Blog</title><link rel="stylesheet" type="text/css" href="/css/style.css?v=0.0.0"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/normalize/4.2.0/normalize.min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/0.6.0/pure-min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/0.6.0/grids-responsive-min.css"><link rel="stylesheet" href="//cdn.bootcss.com/font-awesome/4.6.3/css/font-awesome.min.css"><script type="text/javascript" src="//cdn.bootcss.com/jquery/3.0.0/jquery.min.js"></script><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"><link rel="alternate" type="application/atom+xml" href="/atom.xml"></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">Sort List</h1><a id="logo" href="/.">Xinli's Blog</a><p class="description">Coding World</p></div><div id="nav-menu"><a href="/." class="current"><i class="fa fa-home"> Home</i></a><a href="/archives/"><i class="fa fa-archive"> Archive</i></a><a href="/about/"><i class="fa fa-user"> About</i></a><a href="/atom.xml"><i class="fa fa-rss"> RSS</i></a></div></div><div id="layout" class="pure-g"><div class="pure-u-1 pure-u-md-3-4"><div class="content_container"><div class="post"><h1 class="post-title">Sort List</h1><div class="post-meta">Aug 5, 2016<span> | </span><span class="category"><a href="/categories/Leetcode/">Leetcode</a></span><script src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js" async></script><span id="busuanzi_container_page_pv"> | <span id="busuanzi_value_page_pv"></span><span> Hits</span></span></div><a data-disqus-identifier="2016/08/05/Sort-List/" href="/2016/08/05/Sort-List/#disqus_thread" class="disqus-comment-count"></a><div class="clear"><div id="toc" class="toc-article"><div class="toc-title">Contents</div><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Description"><span class="toc-number">1.</span> <span class="toc-text">Description</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Solution"><span class="toc-number">2.</span> <span class="toc-text">Solution</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Analysis"><span class="toc-number">2.1.</span> <span class="toc-text">Analysis</span></a></li></ol></li></ol></div></div><div class="post-content"><p>This is the solution about <a href="https://leetcode.com/problems/sort-list/" target="_blank" rel="external">Leetcode-Sort List</a>.</p>
<h2 id="Description"><a href="#Description" class="headerlink" title="Description"></a>Description</h2><p>Sort a linked list in O(n log n) time using constant space complexity.</p>
<h2 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h2><h3 id="Analysis"><a href="#Analysis" class="headerlink" title="Analysis"></a>Analysis</h3><p>Solution1: Merge sort with recursive way, divide and conquer. First divide the list into left and right lists, sort them and then merge two lists. But the space complexity is O(log n). Because our iteration is O(n), we need iterate logn round. The time complexity is O(nlogn),but space complexity is O(logn).       </p>
<p>Solution2: From bottom to top, first sort every two ListNodes, then four  nodes until the whole list. Each time we sort in the same list, the space complexity is O(1).</p>
<figure class="highlight nix"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/**</span></div><div class="line"> * Definition for singly-linked list.</div><div class="line"> * public class ListNode &#123;</div><div class="line"> *     int val;</div><div class="line"> *     ListNode next;</div><div class="line"> *     ListNode(int x) &#123; val = x; &#125;</div><div class="line"> * &#125;</div><div class="line"> */</div><div class="line"> </div><div class="line"> // Recursive solution</div><div class="line"> public class Solution1 &#123;</div><div class="line">    public ListNode sortList(ListNode head) &#123;</div><div class="line">        <span class="keyword">if</span>(<span class="attr">head==null</span> || head.<span class="attr">next</span> == <span class="literal">null</span>) return head;</div><div class="line">        ListNode <span class="attr">slow</span> = head, <span class="attr">fast</span> = head, <span class="attr">firstHalf</span> = head;</div><div class="line">        while(fast.next!=<span class="literal">null</span> &amp;&amp; fast.next.next!=<span class="literal">null</span>) &#123;</div><div class="line">        	<span class="attr">slow</span> = slow.next;</div><div class="line">        	<span class="attr">fast</span> = fast.next.next;</div><div class="line">        &#125;</div><div class="line">        ListNode <span class="attr">secondHalf</span> = slow.next;</div><div class="line">        slow.<span class="attr">next</span> = <span class="literal">null</span>;   </div><div class="line">        ListNode <span class="attr">leftList</span> = <span class="literal">null</span>, <span class="attr">rightList</span> = <span class="literal">null</span>;</div><div class="line">        <span class="keyword">if</span>(firstHalf != secondHalf) &#123;</div><div class="line">        	<span class="attr">leftList</span> = sortList(firstHalf);</div><div class="line">        	<span class="attr">rightList</span> = sortList(secondHalf);</div><div class="line">        &#125;</div><div class="line">        return mergeLists(leftList,rightList);</div><div class="line">    &#125;</div><div class="line">    public ListNode mergeLists(ListNode leftList, ListNode rightList) &#123;</div><div class="line">    	<span class="keyword">if</span>(<span class="attr">leftList</span> == <span class="literal">null</span>) return rightList;</div><div class="line">    	<span class="keyword">if</span>(<span class="attr">rightList</span> == <span class="literal">null</span>) return leftList;</div><div class="line">    	ListNode <span class="attr">dummy</span> = new ListNode(-<span class="number">1</span>);</div><div class="line">    	ListNode <span class="attr">newList</span> = dummy;</div><div class="line">    	while(leftList!=<span class="literal">null</span> &amp;&amp; rightList!=<span class="literal">null</span>) &#123;</div><div class="line">    		<span class="keyword">if</span>(leftList.val &gt; rightList.val) &#123;</div><div class="line">    			newList.<span class="attr">next</span> = rightList;</div><div class="line">    			<span class="attr">newList</span> = newList.next;</div><div class="line">    			<span class="attr">rightList</span> = rightList.next;</div><div class="line">    		&#125;<span class="keyword">else</span>&#123;</div><div class="line">    			newList.<span class="attr">next</span> = leftList;</div><div class="line">    			<span class="attr">newList</span> = newList.next;</div><div class="line">    			<span class="attr">leftList</span> = leftList.next;</div><div class="line">    		&#125;</div><div class="line">    	&#125;</div><div class="line">    	<span class="keyword">if</span>(leftList!=<span class="literal">null</span>) &#123;</div><div class="line">    		newList.<span class="attr">next</span> = leftList;</div><div class="line">    	&#125;</div><div class="line">    	<span class="keyword">if</span>(rightList!=<span class="literal">null</span>) &#123;</div><div class="line">    		newList.<span class="attr">next</span> = rightList;</div><div class="line">    	&#125;</div><div class="line">    	return dummy.next;</div><div class="line">    &#125; 	</div><div class="line">&#125;</div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line">//Iterative solution, Bottom to top.</div><div class="line">public class Solution2 &#123;</div><div class="line">	public ListNode sortList(ListNode head) &#123;</div><div class="line">		ListNode <span class="attr">dummy</span> = new ListNode(-<span class="number">1</span>);</div><div class="line">		dummy.<span class="attr">next</span> = head;</div><div class="line">		for(int <span class="attr">i=2;</span> <span class="literal">true</span>; i*=<span class="number">2</span>) &#123;</div><div class="line">			int <span class="attr">numberOfMerge</span> = <span class="number">0</span>;</div><div class="line">			ListNode <span class="attr">newList</span> = dummy;</div><div class="line">			while(newList!=<span class="literal">null</span> &amp;&amp; newList.next!=<span class="literal">null</span>) &#123;</div><div class="line">				<span class="attr">newList</span> = merge(newList,i);</div><div class="line">				numberOfMerge ++;</div><div class="line">			&#125;</div><div class="line">			<span class="keyword">if</span>(numberOfMerge&lt;=<span class="number">1</span>) break;</div><div class="line">		&#125;</div><div class="line">		return dummy.next;</div><div class="line">	&#125;</div><div class="line">	public ListNode merge(ListNode newList, int length) &#123;</div><div class="line">		<span class="keyword">if</span>(<span class="attr">newList==null</span> || newList.<span class="attr">next==null)</span> return <span class="literal">null</span>;</div><div class="line">		ListNode <span class="attr">firstStart</span> = newList.next;</div><div class="line">		ListNode <span class="attr">firstEnd</span> = move(firstStart,length/<span class="number">2</span>-<span class="number">1</span>);</div><div class="line">		<span class="keyword">if</span>(<span class="attr">firstEnd</span> == <span class="literal">null</span>) return <span class="literal">null</span>;</div><div class="line">		ListNode <span class="attr">secondStart</span> = firstEnd.next;</div><div class="line">		firstEnd.<span class="attr">next</span> = <span class="literal">null</span>;</div><div class="line">		ListNode <span class="attr">secondEnd</span> = move(secondStart,length/<span class="number">2</span>-<span class="number">1</span>);</div><div class="line">		ListNode <span class="attr">secondEndNext</span> = secondEnd!=<span class="literal">null</span>? secondEnd.next : <span class="literal">null</span>;</div><div class="line">		<span class="keyword">if</span>(secondEndNext!=<span class="literal">null</span>) secondEnd.<span class="attr">next</span> = <span class="literal">null</span>;</div><div class="line">		while(firstStart!=<span class="literal">null</span> || secondStart!=<span class="literal">null</span>) &#123;</div><div class="line">    		<span class="keyword">if</span>(<span class="attr">secondStart==null</span> ||(firstStart!=<span class="literal">null</span> &amp;&amp; firstStart.val &lt; secondStart.val)) &#123;</div><div class="line">    			newList.<span class="attr">next</span> = firstStart;</div><div class="line">    			<span class="attr">newList</span> = newList.next;</div><div class="line">    			<span class="attr">firstStart</span> = firstStart.next;</div><div class="line">    		&#125;<span class="keyword">else</span>&#123;</div><div class="line">    			newList.<span class="attr">next</span> = secondStart;</div><div class="line">    			<span class="attr">newList</span> = newList.next;</div><div class="line">    			<span class="attr">secondStart</span> = secondStart.next;</div><div class="line">    		&#125;</div><div class="line">    	&#125;</div><div class="line">    	<span class="keyword">if</span>(firstStart!=<span class="literal">null</span>) &#123;</div><div class="line">    		newList.<span class="attr">next</span> = firstStart;</div><div class="line">    	&#125;</div><div class="line">    	<span class="keyword">if</span>(secondStart!=<span class="literal">null</span>) &#123;</div><div class="line">    		newList.<span class="attr">next</span> = secondStart;</div><div class="line">    	&#125;</div><div class="line">    	<span class="attr">newList</span> = newList.next;</div><div class="line">    	newList.<span class="attr">next</span> = secondEndNext;</div><div class="line">    	return newList;</div><div class="line">	&#125;</div><div class="line">	public ListNode move(ListNode head, int moveBy)&#123;</div><div class="line">		while(head!=<span class="literal">null</span> &amp;&amp; moveBy&gt;<span class="number">0</span>)&#123;</div><div class="line">			<span class="attr">head</span> = head.next;</div><div class="line">			moveBy--;</div><div class="line">		&#125;</div><div class="line">		return head;</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></div><script type="text/javascript" src="/js/share.js?v=0.0.0" async></script><a data-url="http://xinli90.com/2016/08/05/Sort-List/" data-id="cit9d9txq0053jju0788hh46i" class="article-share-link">Share</a><div class="tags"><a href="/tags/Leetcode/">Leetcode</a></div><div class="post-nav"><a href="/2016/08/06/Insertion-Sort-List/" class="pre">Insertion Sort List</a><a href="/2016/08/05/Merge-k-Sorted-Lists/" class="next">Merge k Sorted Lists</a></div><div id="disqus_thread"><script>var disqus_shortname = 'xinli';
var disqus_identifier = '2016/08/05/Sort-List/';
var disqus_title = 'Sort List';
var disqus_url = 'http://xinli90.com/2016/08/05/Sort-List/';
(function() {
  var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
  dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
  (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();</script><script id="dsq-count-scr" src="//xinli.disqus.com/count.js" async></script></div></div></div></div><div class="pure-u-1-4"><div id="sidebar"><div class="widget"><div class="widget-title"><i class="fa fa-star-o"> Tags</i></div><div class="tagcloud"><a href="/tags/Leetcode/" style="font-size: 15px;">Leetcode</a> <a href="/tags/Seeking-Job/" style="font-size: 15px;">Seeking Job</a> <a href="/tags/J2EE/" style="font-size: 15px;">J2EE</a> <a href="/tags/Hexo/" style="font-size: 15px;">Hexo</a> <a href="/tags/iOS/" style="font-size: 15px;">iOS</a></div></div><div class="widget"><div class="widget-title"><i class="fa fa-folder-o"> Categories</i></div><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/Algorithm/">Algorithm</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Data-Structure/">Data Structure</a><span class="category-list-count">6</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Geek/">Geek</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/J2EE/">J2EE</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/JAVA/">JAVA</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Leetcode/">Leetcode</a><span class="category-list-count">54</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Multithreading/">Multithreading</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/class-design/">class design</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/iOS/">iOS</a><span class="category-list-count">1</span></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-file-o"> Recent</i></div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2016/09/18/Jump-Game/">Jump Game</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/09/18/Climbing-Stairs/">Climbing Stairs</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/09/18/Unique-Paths/">Unique Paths</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/09/18/Minimum-Path-Sum/">Minimum Path Sum</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/09/18/Triangle/">Triangle</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/09/16/Number-of-Islands/">Number of Islands</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/09/16/Add-Binary/">Add Binary</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/09/15/First-Bad-Version/">First Bad Version</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/09/13/Top-K-Frequent-Elements/">Top K Frequent Elements</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/09/11/Number-of-1-Bits/">Number of 1 Bits</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-comment-o"> Recent Comments</i></div><script type="text/javascript" src="//xinli.disqus.com/recent_comments_widget.js?num_items=5&amp;hide_avatars=1&amp;avatar_size=32&amp;excerpt_length=20&amp;hide_mods=1"></script></div><div class="widget"><div class="widget-title"><i class="fa fa-external-link"> Blogroll</i></div><ul></ul><a href="null" title="null" target="_blank"></a><ul></ul><a href="null" title="null" target="_blank"></a><ul></ul><a href="null" title="null" target="_blank"></a></div></div></div><div class="pure-u-1 pure-u-md-3-4"><div id="footer">© <a href="/." rel="nofollow">Xinli's Blog.</a> Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a><a rel="nofollow" target="_blank" href="https://github.com/tufu9441/maupassant-hexo"> Theme</a> by<a rel="nofollow" target="_blank" href="https://github.com/pagecho"> Cho.</a></div></div></div><a id="rocket" href="#top" class="show"></a><script type="text/javascript" src="/js/totop.js?v=0.0.0" async></script><script type="text/javascript" src="//cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.pack.js" async></script><script type="text/javascript" src="/js/fancybox.js?v=0.0.0" async></script><link rel="stylesheet" type="text/css" href="/css/jquery.fancybox.css?v=0.0.0"><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
ga('create','UA-83440669-1','auto');ga('send','pageview');
</script><script type="text/javascript" src="/js/codeblock-resizer.js?v=0.0.0"></script><script type="text/javascript" src="/js/smartresize.js?v=0.0.0"></script></div></body></html>