<!DOCTYPE html><html lang="en"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description"><title>Sort List | Xinli's Blog</title><link rel="stylesheet" type="text/css" href="/css/style.css?v=0.0.0"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/normalize/4.2.0/normalize.min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/0.6.0/pure-min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/0.6.0/grids-responsive-min.css"><link rel="stylesheet" href="//cdn.bootcss.com/font-awesome/4.6.3/css/font-awesome.min.css"><script type="text/javascript" src="//cdn.bootcss.com/jquery/3.0.0/jquery.min.js"></script><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">Sort List</h1><a id="logo" href="/.">Xinli's Blog</a><p class="description"></p></div><div id="nav-menu"><a href="/." class="current"><i class="fa fa-home"> Home</i></a><a href="/archives/"><i class="fa fa-archive"> Archive</i></a><a href="/about/"><i class="fa fa-user"> About</i></a><a href="/atom.xml"><i class="fa fa-rss"> RSS</i></a></div></div><div id="layout" class="pure-g"><div class="pure-u-1 pure-u-md-3-4"><div class="content_container"><div class="post"><h1 class="post-title">Sort List</h1><div class="post-meta">Aug 5, 2016<span> | </span><span class="category"><a href="/categories/Leetcode/">Leetcode</a></span><script src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js" async></script><span id="busuanzi_container_page_pv"> | <span id="busuanzi_value_page_pv"></span><span> Hits</span></span></div><div class="post-content"><p>This is the solution about <a href="https://leetcode.com/problems/sort-list/" target="_blank" rel="external">Leetcode-Sort List</a>.</p>
<h2 id="Description"><a href="#Description" class="headerlink" title="Description:"></a>Description:</h2><p>Sort a linked list in O(n log n) time using constant space complexity.</p>
<h2 id="Solution"><a href="#Solution" class="headerlink" title="Solution:"></a>Solution:</h2><h4 id="Analysis"><a href="#Analysis" class="headerlink" title="Analysis:"></a>Analysis:</h4><p>Solution1: Merge sort with recursive way, divide and conquer. First divide the list into left and right lists, sort them and then merge two lists. But the space complexity is O(log n). Because our iteration is O(n), we need iterate logn round. The time complexity is O(nlogn),but space complexity is O(logn).       </p>
<p>Solution2: From bottom to top, first sort every two ListNodes, then four  nodes until the whole list. Each time we sort in the same list, the space complexity is O(1).</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div></pre></td><td class="code"><pre><div class="line">/**</div><div class="line"> * Definition for singly-linked list.</div><div class="line"> * public class ListNode &#123;</div><div class="line"> *     int val;</div><div class="line"> *     ListNode next;</div><div class="line"> *     ListNode(int x) &#123; val = x; &#125;</div><div class="line"> * &#125;</div><div class="line"> */</div><div class="line"> </div><div class="line"> // Recursive solution</div><div class="line"> public class Solution1 &#123;</div><div class="line">    public ListNode sortList(ListNode head) &#123;</div><div class="line">        if(head==null || head.next == null) return head;</div><div class="line">        ListNode slow = head, fast = head, firstHalf = head;</div><div class="line">        while(fast.next!=null &amp;&amp; fast.next.next!=null) &#123;</div><div class="line">        	slow = slow.next;</div><div class="line">        	fast = fast.next.next;</div><div class="line">        &#125;</div><div class="line">        ListNode secondHalf = slow.next;</div><div class="line">        slow.next = null;   </div><div class="line">        ListNode leftList = null, rightList = null;</div><div class="line">        if(firstHalf != secondHalf) &#123;</div><div class="line">        	leftList = sortList(firstHalf);</div><div class="line">        	rightList = sortList(secondHalf);</div><div class="line">        &#125;</div><div class="line">        return mergeLists(leftList,rightList);</div><div class="line">    &#125;</div><div class="line">    public ListNode mergeLists(ListNode leftList, ListNode rightList) &#123;</div><div class="line">    	if(leftList == null) return rightList;</div><div class="line">    	if(rightList == null) return leftList;</div><div class="line">    	ListNode dummy = new ListNode(-1);</div><div class="line">    	ListNode newList = dummy;</div><div class="line">    	while(leftList!=null &amp;&amp; rightList!=null) &#123;</div><div class="line">    		if(leftList.val &gt; rightList.val) &#123;</div><div class="line">    			newList.next = rightList;</div><div class="line">    			newList = newList.next;</div><div class="line">    			rightList = rightList.next;</div><div class="line">    		&#125;else&#123;</div><div class="line">    			newList.next = leftList;</div><div class="line">    			newList = newList.next;</div><div class="line">    			leftList = leftList.next;</div><div class="line">    		&#125;</div><div class="line">    	&#125;</div><div class="line">    	if(leftList!=null) &#123;</div><div class="line">    		newList.next = leftList;</div><div class="line">    	&#125;</div><div class="line">    	if(rightList!=null) &#123;</div><div class="line">    		newList.next = rightList;</div><div class="line">    	&#125;</div><div class="line">    	return dummy.next;</div><div class="line">    &#125; 	</div><div class="line">&#125;</div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line">//Iterative solution, Bottom to top.</div><div class="line">public class Solution2 &#123;</div><div class="line">	public ListNode sortList(ListNode head) &#123;</div><div class="line">		ListNode dummy = new ListNode(-1);</div><div class="line">		dummy.next = head;</div><div class="line">		for(int i=2; true; i*=2) &#123;</div><div class="line">			int numberOfMerge = 0;</div><div class="line">			ListNode newList = dummy;</div><div class="line">			while(newList!=null &amp;&amp; newList.next!=null) &#123;</div><div class="line">				newList = merge(newList,i);</div><div class="line">				numberOfMerge ++;</div><div class="line">			&#125;</div><div class="line">			if(numberOfMerge&lt;=1) break;</div><div class="line">		&#125;</div><div class="line">		return dummy.next;</div><div class="line">	&#125;</div><div class="line">	public ListNode merge(ListNode newList, int length) &#123;</div><div class="line">		if(newList==null || newList.next==null) return null;</div><div class="line">		ListNode firstStart = newList.next;</div><div class="line">		ListNode firstEnd = move(firstStart,length/2-1);</div><div class="line">		if(firstEnd == null) return null;</div><div class="line">		ListNode secondStart = firstEnd.next;</div><div class="line">		firstEnd.next = null;</div><div class="line">		ListNode secondEnd = move(secondStart,length/2-1);</div><div class="line">		ListNode secondEndNext = secondEnd!=null? secondEnd.next : null;</div><div class="line">		if(secondEndNext!=null) secondEnd.next = null;</div><div class="line">		while(firstStart!=null || secondStart!=null) &#123;</div><div class="line">    		if(secondStart==null ||(firstStart!=null &amp;&amp; firstStart.val &lt; secondStart.val)) &#123;</div><div class="line">    			newList.next = firstStart;</div><div class="line">    			newList = newList.next;</div><div class="line">    			firstStart = firstStart.next;</div><div class="line">    		&#125;else&#123;</div><div class="line">    			newList.next = secondStart;</div><div class="line">    			newList = newList.next;</div><div class="line">    			secondStart = secondStart.next;</div><div class="line">    		&#125;</div><div class="line">    	&#125;</div><div class="line">    	if(firstStart!=null) &#123;</div><div class="line">    		newList.next = firstStart;</div><div class="line">    	&#125;</div><div class="line">    	if(secondStart!=null) &#123;</div><div class="line">    		newList.next = secondStart;</div><div class="line">    	&#125;</div><div class="line">    	newList = newList.next;</div><div class="line">    	newList.next = secondEndNext;</div><div class="line">    	return newList;</div><div class="line">	&#125;</div><div class="line">	public ListNode move(ListNode head, int moveBy)&#123;</div><div class="line">		while(head!=null &amp;&amp; moveBy&gt;0)&#123;</div><div class="line">			head = head.next;</div><div class="line">			moveBy--;</div><div class="line">		&#125;</div><div class="line">		return head;</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></div><script type="text/javascript" src="/js/share.js?v=0.0.0" async></script><a data-url="http://yoursite.com/2016/08/05/Sort-List/" data-id="cisccuy97003irejhb1szdul2" class="article-share-link">Share</a><div class="tags"><a href="/tags/Leetcode/">Leetcode</a></div><div class="post-nav"><a href="/2016/08/06/Insertion-Sort-List/" class="pre">Insertion Sort List</a><a href="/2016/08/05/Merge-k-Sorted-Lists/" class="next">Merge k Sorted Lists</a></div></div></div></div><div class="pure-u-1-4"><div id="sidebar"><div class="widget"><form action="//www.google.com/search" method="get" accept-charset="utf-8" target="_blank" class="search-form"><input type="text" name="q" maxlength="20" placeholder="Search"/><input type="hidden" name="sitesearch" value="http://yoursite.com"/></form></div><div class="widget"><div class="widget-title"><i class="fa fa-star-o"> Tags</i></div><div class="tagcloud"><a href="/tags/Leetcode/" style="font-size: 15px;">Leetcode</a> <a href="/tags/Seeking-Job/" style="font-size: 15px;">Seeking Job</a> <a href="/tags/Hexo/" style="font-size: 15px;">Hexo</a> <a href="/tags/iOS/" style="font-size: 15px;">iOS</a></div></div><div class="widget"><div class="widget-title"><i class="fa fa-folder-o"> Categories</i></div><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/Algorithm-Binary-Tree/">Algorithm, Binary Tree</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Algorithm-Sorting/">Algorithm, Sorting</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Data-Structure-Collection/">Data Structure, Collection</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Data-Structure-HashMap-TreeMap-Hashtable-ConcuttentHashMap/">Data Structure, HashMap, TreeMap, Hashtable, ConcuttentHashMap</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Data-Structure-HashSet-TreeSet/">Data Structure, HashSet, TreeSet</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Data-Structure-List/">Data Structure, List</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Geek/">Geek</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Leetcode/">Leetcode</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Stack-Heap/">Stack, Heap</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/class-design-interface/">class design, interface</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/comparator-comparable/">comparator, comparable</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/iOS/">iOS</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-file-o"> Recent</i></div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2016/08/25/Lowest-Common-Ancestor-of-a-Binary-Tree/">Lowest Common Ancestor of a Binary Tree</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/08/25/Construct-Binary-Tree-from-Preorder-and-Inorder-Traversal/">Construct Binary Tree from Preorder and Inorder Traversal</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/08/24/Balanced-Binary-Tree/">Balanced Binary Tree</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/08/24/Same-Tree/">Same Tree</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/08/23/Flatten-Binary-Tree-to-Linked-List/">Flatten Binary Tree to Linked List</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/08/23/Binary-Tree-Level-Order-Traversal/">Binary Tree Level Order Traversal</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/08/23/Binary-Tree-Postorder-Traversal/">Binary Tree Postorder Traversal</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/08/23/Binary-Tree-Inorder-Traversal/">Binary Tree Inorder Traversal</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/08/23/Binary-Tree-Preorder-Traversal/">Binary Tree Preorder Traversal</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/08/23/Maximum-Depth-of-Binary-Tree/">Maximum Depth of Binary Tree</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-external-link"> Blogroll</i></div><ul></ul><a href="http://www.example1.com/" title="site-name1" target="_blank">site-name1</a><ul></ul><a href="http://www.example2.com/" title="site-name2" target="_blank">site-name2</a><ul></ul><a href="http://www.example3.com/" title="site-name3" target="_blank">site-name3</a></div></div></div><div class="pure-u-1 pure-u-md-3-4"><div id="footer">© <a href="/." rel="nofollow">Xinli's Blog.</a> Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a><a rel="nofollow" target="_blank" href="https://github.com/tufu9441/maupassant-hexo"> Theme</a> by<a rel="nofollow" target="_blank" href="https://github.com/pagecho"> Cho.</a></div></div></div><a id="rocket" href="#top" class="show"></a><script type="text/javascript" src="/js/totop.js?v=0.0.0" async></script><script type="text/javascript" src="//cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.pack.js" async></script><script type="text/javascript" src="/js/fancybox.js?v=0.0.0" async></script><link rel="stylesheet" type="text/css" href="/css/jquery.fancybox.css?v=0.0.0"><script type="text/javascript" src="/js/codeblock-resizer.js?v=0.0.0"></script><script type="text/javascript" src="/js/smartresize.js?v=0.0.0"></script></div></body></html>