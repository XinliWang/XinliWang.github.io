<!DOCTYPE html><html lang="en"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description"><meta name="google-site-verification" content="GY3xi-El9ePp4mSskpCuCNS4x4elE7wbFPe2eKCtS8Y"><title>Day19 DataBase | Xinli's Blog</title><link rel="stylesheet" type="text/css" href="/css/style.css?v=0.0.0"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/normalize/4.2.0/normalize.min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/0.6.0/pure-min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/0.6.0/grids-responsive-min.css"><link rel="stylesheet" href="//cdn.bootcss.com/font-awesome/4.6.3/css/font-awesome.min.css"><script type="text/javascript" src="//cdn.bootcss.com/jquery/3.0.0/jquery.min.js"></script><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"><link rel="alternate" type="application/atom+xml" href="/atom.xml"></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">Day19 DataBase</h1><a id="logo" href="/.">Xinli's Blog</a><p class="description">Coding World</p></div><div id="nav-menu"><a href="/." class="current"><i class="fa fa-home"> Home</i></a><a href="/archives/"><i class="fa fa-archive"> Archive</i></a><a href="/about/"><i class="fa fa-user"> About</i></a><a href="/atom.xml"><i class="fa fa-rss"> RSS</i></a></div></div><div id="layout" class="pure-g"><div class="pure-u-1 pure-u-md-3-4"><div class="content_container"><div class="post"><h1 class="post-title">Day19 DataBase</h1><div class="post-meta">Oct 11, 2016<span> | </span><span class="category"><a href="/categories/Database/">Database</a></span><script src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js" async></script><span id="busuanzi_container_page_pv"> | <span id="busuanzi_value_page_pv"></span><span> Hits</span></span></div><a data-disqus-identifier="2016/10/11/Day19-DataBase/" href="/2016/10/11/Day19-DataBase/#disqus_thread" class="disqus-comment-count"></a><div class="clear"><div id="toc" class="toc-article"><div class="toc-title">Contents</div><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#攻略模板"><span class="toc-number">1.</span> <span class="toc-text">攻略模板</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Relational-DB-and-NoSql"><span class="toc-number">2.</span> <span class="toc-text">Relational DB and NoSql</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#学习后总结"><span class="toc-number">3.</span> <span class="toc-text">学习后总结</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#UNION-and-UNION-ALL"><span class="toc-number">3.1.</span> <span class="toc-text">UNION and UNION ALL</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#JOIN"><span class="toc-number">3.2.</span> <span class="toc-text">JOIN</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#count"><span class="toc-number">3.3.</span> <span class="toc-text">count</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#is"><span class="toc-number">3.4.</span> <span class="toc-text">is</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#NOT-IN"><span class="toc-number">3.5.</span> <span class="toc-text">NOT IN</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Execution-order"><span class="toc-number">3.6.</span> <span class="toc-text">Execution order</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#WHERE-and-HAVING"><span class="toc-number">3.7.</span> <span class="toc-text">WHERE and HAVING</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#常见考题"><span class="toc-number">4.</span> <span class="toc-text">常见考题</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#参考-Reference-："><span class="toc-number">4.1.</span> <span class="toc-text">参考(Reference)：</span></a></li></ol></li></ol></div></div><div class="post-content"><p>本篇是关于Database的介绍和用途.</p>
<h2 id="攻略模板"><a href="#攻略模板" class="headerlink" title="攻略模板"></a>攻略模板</h2><ul>
<li>总结归纳各种SQL特性</li>
<li>总结用法和分析优化思路</li>
</ul>
<h2 id="Relational-DB-and-NoSql"><a href="#Relational-DB-and-NoSql" class="headerlink" title="Relational DB and NoSql"></a>Relational DB and NoSql</h2><ul>
<li><p>NoSQL与Relational DB区别：SQL databases store data in form of tables, rows, columns and records. This data is stored in a pre-defined data model which is not very much flexible for today’s real-world highly growing applications. NoSql in contrast uses a flexible structure which can be easily modified and extended.</p>
</li>
<li><p>NoSql: A NoSql database provides a mechanism for storage and retrieval of data that is modeled. The types : Document Oriented, Key Value, Graph, Column Oriented.</p>
</li>
<li><p>MongoDB: It is a document oriented database. It stores data in the form of BSON structure based documents. These documents are stored in a collection. Advantage: Flexible data model in form of documents, Agile and highly scalable database, Faster than traditional databases, Expressive query language.</p>
</li>
</ul>
<h2 id="学习后总结"><a href="#学习后总结" class="headerlink" title="学习后总结"></a>学习后总结</h2><h3 id="UNION-and-UNION-ALL"><a href="#UNION-and-UNION-ALL" class="headerlink" title="UNION and UNION ALL"></a>UNION and UNION ALL</h3><ul>
<li><p>UNION:Merge two structurally-compatible tables into a single table and omit the duplicate records.</p>
</li>
<li><p>UNION ALL: Merge contents of two tables into one table but include duplicate records. It is more efficient than UNION, because it doesn’t need omit duplicate records.</p>
</li>
</ul>
<h3 id="JOIN"><a href="#JOIN" class="headerlink" title="JOIN"></a>JOIN</h3><ul>
<li><p>INNER JOIN: The simple and default join.</p>
</li>
<li><p>LEFT JOIN: Returns all rows from the left table, and the matched rows from the right table. This means that if the ON clause doesn’t match any records in the right table, the JOIN will still return a row in the result for that record in the left table, but with NULL in each column from the right table.</p>
</li>
<li><p>RIGHT JOIN: Returns all rows from the right table, and the matched rows from the left table. </p>
</li>
<li><p>FULL JOIN: Combine LEFT JOIN and RIGHT JOIN, return all rows for which there is a match in either of the tables. Its result is similar with UNION. (with NULL for some columns)</p>
</li>
<li><p>CROSS JOIN: Returns all records where each row from the first table is combined with each row from the second table.</p>
</li>
</ul>
<h3 id="count"><a href="#count" class="headerlink" title="count"></a>count</h3><p>customer id 不为123 的客户的数量：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">select</span> <span class="keyword">count</span>(*) <span class="keyword">AS</span> cust_not_total </div><div class="line"><span class="keyword">from</span> orders</div><div class="line"><span class="keyword">where</span> customer_id &lt;&gt; <span class="string">'123'</span></div></pre></td></tr></table></figure>
<p>注意： Any records with a customer_id of NULL will not be included in either count.</p>
<h3 id="is"><a href="#is" class="headerlink" title="is"></a>is</h3><p>Use <code>is</code> instead of <code>=</code>, when we want to compare a value to null.</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">//expected result is YUP</div><div class="line"><span class="keyword">select</span> <span class="keyword">case</span></div><div class="line"><span class="keyword">when</span> <span class="literal">null</span> <span class="keyword">is</span> <span class="literal">null</span></div><div class="line"><span class="keyword">then</span> <span class="string">'YUP'</span> <span class="keyword">else</span> <span class="string">'Nope'</span></div><div class="line"><span class="keyword">end</span> <span class="keyword">as</span> <span class="keyword">Result</span></div></pre></td></tr></table></figure>
<p>Anything compared to <code>NULL</code> evaluates to <code>UNKNOWN</code>, it includes NULL itself.</p>
<p>So below sql cannot get the result which ReferreddBy == NULL.</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">Select</span> <span class="keyword">Name</span> <span class="keyword">From</span> Customers</div><div class="line"><span class="keyword">Where</span> ReferreddBy &lt;&gt; <span class="number">2</span></div></pre></td></tr></table></figure>
<p>We should use:</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">Select</span> <span class="keyword">Name</span> <span class="keyword">From</span> Customers</div><div class="line"><span class="keyword">Where</span> ReferreddBy <span class="keyword">IS</span> <span class="literal">NULL</span> <span class="keyword">OR</span> ReferreddBy &lt;&gt; <span class="number">2</span></div></pre></td></tr></table></figure>
<h3 id="NOT-IN"><a href="#NOT-IN" class="headerlink" title="NOT IN"></a>NOT IN</h3><p>If the set being evaluated by the <code>NOT IN</code> contains any null values, the result will return an empty set.</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">Select</span> *</div><div class="line"><span class="keyword">from</span> runners</div><div class="line"><span class="keyword">where</span> runners.id <span class="keyword">NOT</span> <span class="keyword">IN</span></div><div class="line">(<span class="keyword">select</span> winner_id <span class="keyword">from</span> races <span class="keyword">where</span> winner_id <span class="keyword">IS</span> <span class="keyword">NOT</span> <span class="literal">null</span>)</div></pre></td></tr></table></figure>
<p>For MySql:</p>
<figure class="highlight moonscript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">select</span> * <span class="keyword">from</span> A</div><div class="line"><span class="keyword">not</span> <span class="keyword">in</span> </div><div class="line"><span class="built_in">select</span> * <span class="keyword">from</span> B</div></pre></td></tr></table></figure>
<p>For Sql Sergver, SQLite,PostgreSQL, we can also use:</p>
<figure class="highlight oxygene"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">select</span> * <span class="keyword">from</span> A</div><div class="line"><span class="keyword">except</span></div><div class="line"><span class="keyword">select</span> * <span class="keyword">from</span> B</div></pre></td></tr></table></figure>
<p>For Oracle, we can use <code>minus</code>.</p>
<h3 id="Execution-order"><a href="#Execution-order" class="headerlink" title="Execution order"></a>Execution order</h3><p>The sql statement is not processed generally top-to-bottom or left-to-right. It’s in differenct order.<br>So this is wrong:</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">SELECT</span> <span class="keyword">Id</span>, <span class="keyword">YEAR</span>(BillingDate) <span class="keyword">AS</span> BillingYear</div><div class="line"><span class="keyword">FROM</span> Invoices</div><div class="line"><span class="keyword">WHERE</span> BillingYear &gt;= <span class="number">2010</span>;</div></pre></td></tr></table></figure>
<p>It should be:</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">SELECT</span> <span class="keyword">Id</span>, <span class="keyword">YEAR</span>(BillingDate) <span class="keyword">AS</span> BillingYear</div><div class="line"><span class="keyword">FROM</span> Invoices</div><div class="line"><span class="keyword">WHERE</span> <span class="keyword">YEAR</span>(BillingDate) &gt;= <span class="number">2010</span>;</div></pre></td></tr></table></figure>
<h3 id="WHERE-and-HAVING"><a href="#WHERE-and-HAVING" class="headerlink" title="WHERE and HAVING"></a>WHERE and HAVING</h3><p>When <code>GROUP BY</code> is not used, the <code>WHERE</code> and <code>HAVING</code> clauses are essentially equivalent.</p>
<p>However, when <code>GROUP BY</code> is used:</p>
<ul>
<li>The <code>WHERE</code> clause is used to filter records from a result. The filtering occurs before any grouping are made.</li>
<li>The <code>HAVING</code> clause is used to filter values from a group(to check conditions after aggregation into groups has been performed).</li>
</ul>
<h2 id="常见考题"><a href="#常见考题" class="headerlink" title="常见考题"></a>常见考题</h2><ol>
<li>Write a SQL query to find the 10th highest employee salary from an Employee table. Explain your answer.</li>
</ol>
<p>For MySQL and PostreSQL, we can use <code>LIMIT</code></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">select</span> Salary <span class="keyword">from</span></div><div class="line">(</div><div class="line">	<span class="keyword">select</span> <span class="keyword">distinct</span> Salary <span class="keyword">from</span> Employee</div><div class="line">	<span class="keyword">Order</span> <span class="keyword">by</span> Salary <span class="keyword">DESC</span> <span class="keyword">LIMIT</span> <span class="number">10</span></div><div class="line">) <span class="keyword">AS</span> Emp <span class="keyword">ORDER</span> <span class="keyword">BY</span> Salary <span class="keyword">LIMIT</span> <span class="number">1</span>;</div></pre></td></tr></table></figure>
<p>For other database, we can use <code>TOP</code></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">select</span> TOP(<span class="number">1</span>) Salary <span class="keyword">From</span></div><div class="line">(</div><div class="line">	<span class="keyword">select</span> <span class="keyword">distinct</span> TOP(<span class="number">10</span>) Salary</div><div class="line">	<span class="keyword">From</span> Employee</div><div class="line">	<span class="keyword">Order</span> <span class="keyword">by</span> Salary <span class="keyword">DESC</span></div><div class="line">) <span class="keyword">AS</span> Emp <span class="keyword">Order</span> <span class="keyword">by</span> Salary;</div></pre></td></tr></table></figure>
<h3 id="参考-Reference-："><a href="#参考-Reference-：" class="headerlink" title="参考(Reference)："></a>参考(Reference)：</h3><p><a href="">https://www.toptal.com/sql/interview-questions</a></p>
</div><script type="text/javascript" src="/js/share.js?v=0.0.0" async></script><a data-url="http://xinli90.com/2016/10/11/Day19-DataBase/" data-id="ciuiitok10029tiu0ehi06sha" class="article-share-link">Share</a><div class="tags"><a href="/tags/Seeking-Job/">Seeking Job</a></div><div class="post-nav"><a href="/2016/10/11/Linked-List-Random-Node/" class="pre">Linked List Random Node</a><a href="/2016/10/09/Day18-Design-Pattern/" class="next">Day18 Design Pattern</a></div><div id="disqus_thread"><script>var disqus_shortname = 'xinli';
var disqus_identifier = '2016/10/11/Day19-DataBase/';
var disqus_title = 'Day19 DataBase';
var disqus_url = 'http://xinli90.com/2016/10/11/Day19-DataBase/';
(function() {
  var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
  dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
  (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();</script><script id="dsq-count-scr" src="//xinli.disqus.com/count.js" async></script></div></div></div></div><div class="pure-u-1-4"><div id="sidebar"><div class="widget"><form action="//www.google.com/search" method="get" accept-charset="utf-8" target="_blank" class="search-form"><input type="text" name="q" maxlength="20" placeholder="Search"/><input type="hidden" name="sitesearch" value="http://xinli90.com"/></form></div><div class="widget"><div class="widget-title"><i class="fa fa-star-o"> Tags</i></div><div class="tagcloud"><a href="/tags/Leetcode/" style="font-size: 15px;">Leetcode</a> <a href="/tags/Seeking-Job/" style="font-size: 15px;">Seeking Job</a> <a href="/tags/J2EE/" style="font-size: 15px;">J2EE</a> <a href="/tags/Hexo/" style="font-size: 15px;">Hexo</a> <a href="/tags/iOS/" style="font-size: 15px;">iOS</a></div></div><div class="widget"><div class="widget-title"><i class="fa fa-folder-o"> Categories</i></div><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/AWS/">AWS</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Algorithm/">Algorithm</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Data-Structure/">Data Structure</a><span class="category-list-count">6</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Database/">Database</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Design-Pattern/">Design Pattern</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Geek/">Geek</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/HTTP/">HTTP</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/J2EE/">J2EE</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/JAVA/">JAVA</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Leetcode/">Leetcode</a><span class="category-list-count">91</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Linux/">Linux</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Multithreading/">Multithreading</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/class-design/">class design</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/iOS/">iOS</a><span class="category-list-count">1</span></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-file-o"> Recent</i></div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2016/10/19/Rotate-Array/">Rotate Array</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/10/19/Remove-Element/">Remove Element</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/10/19/Maximum-XOR-of-Two-Numbers-in-an-Array/">Maximum XOR of Two Numbers in an Array</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/10/17/Reverse-Words-in-a-String/">Reverse Words in a String</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/10/17/Reverse-Words-in-a-String-II/">Reverse Words in a String II</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/10/17/Permutation-Sequence/">Permutation Sequence</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/10/17/Permutations-II/">Permutations II</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/10/16/Next-Permutation/">Next Permutation</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/10/16/Permutations/">Permutations</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/10/13/Remove-Duplicates-from-Sorted-Array/">Remove Duplicates from Sorted Array</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-comment-o"> Recent Comments</i></div><script type="text/javascript" src="//xinli.disqus.com/recent_comments_widget.js?num_items=5&amp;hide_avatars=1&amp;avatar_size=32&amp;excerpt_length=20&amp;hide_mods=1"></script></div><div class="widget"><div class="widget-title"><i class="fa fa-external-link"> Blogroll</i></div><ul></ul><a href="null" title="null" target="_blank"></a><ul></ul><a href="null" title="null" target="_blank"></a><ul></ul><a href="null" title="null" target="_blank"></a></div></div></div><div class="pure-u-1 pure-u-md-3-4"><div id="footer">© <a href="/." rel="nofollow">Xinli's Blog.</a> Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a><a rel="nofollow" target="_blank" href="https://github.com/tufu9441/maupassant-hexo"> Theme</a> by<a rel="nofollow" target="_blank" href="https://github.com/pagecho"> Cho.</a></div></div></div><a id="rocket" href="#top" class="show"></a><script type="text/javascript" src="/js/totop.js?v=0.0.0" async></script><script type="text/javascript" src="//cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.pack.js" async></script><script type="text/javascript" src="/js/fancybox.js?v=0.0.0" async></script><link rel="stylesheet" type="text/css" href="/css/jquery.fancybox.css?v=0.0.0"><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
ga('create','UA-83440669-1','auto');ga('send','pageview');
</script><script type="text/javascript" src="/js/codeblock-resizer.js?v=0.0.0"></script><script type="text/javascript" src="/js/smartresize.js?v=0.0.0"></script></div></body></html>